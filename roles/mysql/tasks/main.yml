---
# Tasks common to all mysql servers

- name: Copy SSL Certificates
  copy: src=packer/etc_ssl_mysql/{{ item.src }} dest=/etc/ssl/mysql/ mode={{ item.mode }} owner=mysql group=mysql
  with_items:
    - { src: ca-key.pem, mode: "0600" }
    - { src: ca.pem, mode: "0644" }
    - { src: client-cert.pem, mode: "0644" }
    - { src: client-key.pem, mode: "0644" }
    - { src: server-cert.pem, mode: "0644" }
    - { src: server-key.pem, mode: "0644" }

- name: Add .my.cnf
  tags: add_dot_my_cnf
  template: src=dotmydotcnf.j2 dest={{ item.path }} owner={{ item.owner }}
  with_items:
  - { path: /root/.my.cnf, owner: root }
  - { path: /home/centos/.my.cnf, owner: centos }
